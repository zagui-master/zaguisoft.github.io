import{form_sign_up,user_name,user_last_name,user_email,user_phone_number,user_password,alert_name,alert_last_name,alert_email,alert_phone_number,alert_password}from"../helpers/locatores.js";import{url}from"../helpers/urls.js";import{regex}from"../helpers/regex.js";const regexName=regex.user,regexLastName=regex.user,regexEmail=regex.email,regexPhonNumber=regex.phone_number,regexPassword=regex.password;let state={name:!1,last_name:!1,email:!1,phone_number:!1,password:!1,verifyExistingAccount:!1},accounts=JSON.parse(sessionStorage.getItem("account"))||[],account_data=[];const updateFieldValidationState=(e,a,t)=>a.test(e.value)?(t.classList.remove("alert-text"),t.textContent="",e.classList.remove("alert-input"),!0):(t.classList.add("alert-text"),t.textContent=`Invalid ${e.name}`,e.classList.add("alert-input"),!1),validateName=()=>{user_name.addEventListener("input",(()=>{state.name=updateFieldValidationState(user_name,regexName,alert_name)}))},validateLastName=()=>{user_last_name.addEventListener("input",(()=>{state.last_name=updateFieldValidationState(user_last_name,regexLastName,alert_last_name)}))},validateEmail=()=>{user_email.addEventListener("input",(()=>{state.email=updateFieldValidationState(user_email,regexEmail,alert_email);-1!==accounts.findIndex((e=>e.email===user_email.value))?(alert_email.classList.add("alert-text"),alert_email.textContent="Email associated with an existing account",user_email.classList.add("alert-input")):state.verifyExistingAccount=!0}))},validatePhoneNumber=()=>{user_phone_number.addEventListener("input",(()=>{state.phone_number=updateFieldValidationState(user_phone_number,regexPhonNumber,alert_phone_number)}))},validatePassword=()=>{user_password.addEventListener("input",(()=>{state.password=updateFieldValidationState(user_password,regexPassword,alert_password)}))},getData=(e,a,t,s,n)=>{safeData({name:e,last_name:a,email:t,phone_number:s,password:n})},safeData=e=>{let a=JSON.parse(sessionStorage.getItem("account"))||[];account_data=[],account_data=account_data.concat(a),account_data.push(e)},sendData=()=>{sessionStorage.setItem("account",JSON.stringify(account_data))};form_sign_up.addEventListener("submit",(e=>{var a,t,s,n,r;e.preventDefault(),console.log(state),state.name&&state.last_name&&state.email&&state.phone_number&&state.password&&state.verifyExistingAccount&&(a=user_name.value,t=user_last_name.value,s=user_email.value.toLowerCase(),n=user_phone_number.value,r=user_password.value,safeData({name:a,last_name:t,email:s,phone_number:n,password:r}),sessionStorage.setItem("account",JSON.stringify(account_data)),form_sign_up.reset(),window.open(url.log_in,"_blank"),window.close())})),user_name.addEventListener("input",(()=>{state.name=updateFieldValidationState(user_name,regexName,alert_name)})),user_last_name.addEventListener("input",(()=>{state.last_name=updateFieldValidationState(user_last_name,regexLastName,alert_last_name)})),user_email.addEventListener("input",(()=>{state.email=updateFieldValidationState(user_email,regexEmail,alert_email),-1!==accounts.findIndex((e=>e.email===user_email.value))?(alert_email.classList.add("alert-text"),alert_email.textContent="Email associated with an existing account",user_email.classList.add("alert-input")):state.verifyExistingAccount=!0})),user_phone_number.addEventListener("input",(()=>{state.phone_number=updateFieldValidationState(user_phone_number,regexPhonNumber,alert_phone_number)})),user_password.addEventListener("input",(()=>{state.password=updateFieldValidationState(user_password,regexPassword,alert_password)}));